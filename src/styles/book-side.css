:root {
  /* Scroll-/Anim-Fortschritt 0..1 (setzen wir per JS) */
  --p: 0;

  /* Buch-Parameter */
  --book-w: min(92vw, 1200px);
  --book-h: calc(var(--book-w) * 0.65); /* Seitenverhältnis */
  --thickness: 38px;                     /* Gesamtdicke des Blocks */
  --spine-thickness: 16px;               /* Der Rücken mittig */
  --page-count: 300;                     /* optische Dicke */
  --flip-count: 10;                      /* wie viele Seiten sanft blättern */

  /* Drehwinkel */
  --tilt-x: 12deg;     /* Kamera leicht von unten */
  --tilt-y: -4deg;     /* minimal perspektivisch */

  /* Zeiten/Fenster */
  --cover-open-start: 0.00;
  --flip-start: 0.15;  /* ab hier beginnen Seiten zu schwingen */
  --flip-end: 0.95;

  /* Farben/Material */
  --paper-a: #fffaf2;
  --paper-b: #fff6e9;
  --edge-line: #e2dccf;
  --edge-shadow: #0000001f;
  --table: radial-gradient(1200px 600px at 50% 10%, #00000010, transparent 70%), var(--bg, #faf7f2);
}

/* Sektion oben */
.bookside-wrap {
  position: relative;
  background: var(--table);
  overflow: clip;
}

/* Bühne: 100vh hoch, direkt im Kopf */
.bookside-stage {
  height: clamp(520px, 92vh, 960px);
  display: grid;
  place-items: center;
  perspective: 1400px;
  perspective-origin: 50% 30%;
}

/* Szene: leichte Kameraneigung (Tischhöhe/Frontansicht) */
.bookside-scene {
  position: relative;
  width: var(--book-w);
  height: var(--book-h);
  transform-style: preserve-3d;
  transform: rotateX(var(--tilt-x)) rotateY(var(--tilt-y)) translateY(8px);
}

/* Bodenschatten */
.bookside-shadow {
  position: absolute;
  inset: auto 10% 4% 10%;
  height: clamp(28px, 5vh, 56px);
  background: radial-gradient(80% 100% at 50% 0%, #00000040, transparent 70%);
  filter: blur(10px);
  transform: translateZ(-100px);
  pointer-events: none;
}

/* Buchkörper (Spine/Block) */
.bookside-core {
  position: absolute;
  inset: 3% 3% 8% 3%;
  transform: translateZ(-8px);
  border-radius: 18px;
  background:
    /* Rückenstreifen (mittig) */
    linear-gradient(90deg, #121212, #1b1b1b 35%, #121212 65%, #0e0e0e) center/var(--spine-thickness) 100% no-repeat,
      /* Gesamtkörper */
    linear-gradient(#0d0d0d, #1a1a1a);
  box-shadow: 0 30px 120px #00000055, inset 0 0 0 1px #00000033;
}

/* Linker Block (Seitenstapel) */
.bookside-left-block, .bookside-right-block {
  position: absolute;
  top: 6%; bottom: 11%;
  width: calc(50% - var(--spine-thickness)/2 - 8px);
  background:
    /* feine Kantenlinien simulieren 300 Seiten */
    repeating-linear-gradient(
      to bottom,
      var(--paper-a) 0 2px,
      var(--paper-b) 2px 4px
    );
  box-shadow: inset 0 0 0 1px #00000010;
  transform-style: preserve-3d;
  will-change: transform;
}

/* Links (vorne) */
.bookside-left-block {
  left: calc(3% + 4px);
  border-radius: 16px 0 0 16px;
  transform: translateZ(1px) rotateY(1deg);
}
/* Rechts (vorne) */
.bookside-right-block {
  right: calc(3% + 4px);
  border-radius: 0 16px 16px 0;
  transform: translateZ(1px) rotateY(-1deg);
  box-shadow:
    inset 16px 0 40px #00000010,
    inset 0 0 0 1px #00000010;
}

/* Edge/Seitenkante (realistische, feine Quetschlinien) */
.bookside-edge {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background:
    linear-gradient(90deg, transparent 40%, #00000010 50%, transparent 60%) center/100% 100% no-repeat,
    repeating-linear-gradient(
      to bottom,
      transparent 0,
      transparent 3px,
      rgba(0,0,0,0.04) 3px,
      transparent 4px
    );
  opacity: .25;
  pointer-events: none;
}

/* Blätternde Seiten (nur links -> nach rechts umschwingen) */
.bookside-flips {
  position: absolute;
  left: calc(50% - var(--spine-thickness)/2 - 2px);
  right: calc(50% - var(--spine-thickness)/2 - 2px);
  top: 6%; bottom: 11%;
  transform-style: preserve-3d;
  perspective: 1100px;
  pointer-events: none;
}

/* Einzelne blätternde Seite */
.flip {
  position: absolute;
  left: auto; right: calc(50% - var(--spine-thickness)/2 - 2px);
  top: 0; bottom: 0;
  width: calc(50% - var(--spine-thickness)/2 - 8px);
  transform-origin: left center;
  border-radius: 14px 0 0 14px;
  backface-visibility: hidden;
  background:
    linear-gradient(90deg, #00000010, transparent 25%) /* Falz-Schattierung */,
    linear-gradient(180deg, var(--paper-a), var(--paper-b));
  box-shadow: 0 10px 26px #0000001e;
  will-change: transform, opacity;
}

/* feiner Flip-Schatten */
.flip::after{
  content:"";
  position:absolute; inset:-1px -1px -1px -1px;
  border-radius: inherit;
  background: radial-gradient(80% 100% at 0% 50%, #0000002a, transparent 60%);
  opacity: var(--shade, 0);
  transition: opacity .12s linear;
}

/* Wir verteilen 10 Seiten (Index 0..9) über den Bereich flip-start..flip-end */
.flip { --n: var(--flip-count); }
.flip { --i: 0 }
.flip:nth-child(2){ --i: 1 }
.flip:nth-child(3){ --i: 2 }
.flip:nth-child(4){ --i: 3 }
.flip:nth-child(5){ --i: 4 }
.flip:nth-child(6){ --i: 5 }
.flip:nth-child(7){ --i: 6 }
.flip:nth-child(8){ --i: 7 }
.flip:nth-child(9){ --i: 8 }
.flip:nth-child(10){ --i: 9 }

/* Zeitfenster pro Seite */
.flip{
  --t0: calc(var(--flip-start) + (var(--i) / var(--n)) * (var(--flip-end) - var(--flip-start)));
  --t1: calc(var(--t0) + (var(--flip-end) - var(--flip-start)) / var(--n));
  --local: clamp((var(--p) - var(--t0)) / max(0.0001, (var(--t1) - var(--t0))), 0, 1);

  /* sanfte S-Kurve (ease-in-out) */
  --e: calc( (1 - cos(var(--local) * 3.14159)) / 2 );

  /* Winkel von 0° -> ~-170° (fast umgeschlagen) */
  --angle: calc(-170deg * var(--e));
  transform: rotateY(var(--angle)) translateZ(calc(var(--i) * 0.15px));
  --shade: calc(var(--e) * .55);
}

/* Rechte feste Leseseite (sichtbar) – hier kannst du echten Text/CTA platzieren */
.bookside-right-content {
  position: absolute;
  inset: 10% 6% 14% calc(50% + var(--spine-thickness)/2 + 18px);
  display: flex;
  flex-direction: column;
  gap: 12px;
  pointer-events: none;
}
.line { height: 10px; border-radius: 6px; background: #00000018 }
.line:nth-child(1){ width: 70% }
.line:nth-child(2){ width: 90% }
.line:nth-child(3){ width: 55% }
.line:nth-child(4){ width: 78% }
.line:nth-child(5){ width: 46% }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .flip { transition: none }
}
